/**
 * @author Doraemon
 * @name Bncr_spy定时任务功能插件
 * @origin 红灯区
 * @version 1.0.7
 * @description Bncr_spy定时任务相关功能插件
 * @rule ^(定时) (\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) (https:\/\/[A-Za-z0-9\-\._~:\/\?#\[\]@!$&'\*\+,%;\=]*)
 * @rule ^(定时) (\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) (export[ ]{1}[^ ]+[ ]*=[ ]*"{1}([^ "]+)"{1})
 * @rule ^(定时) ([0-9]+ [0-9]+ [0-9]+ [0-9]+ [0-9]+ \*{1}) (https:\/\/[A-Za-z0-9\-\._~:\/\?#\[\]@!$&'\*\+,%;\=]*)
 * @rule ^(定时) ([0-9]+ [0-9]+ [0-9]+ [0-9]+ [0-9]+ \*{1}) (export[ ]{1}[^ ]+[ ]*=[ ]*"{1}([^ "]+)"{1})
 * @rule ^(清空过期定时任务|扫描重复定时任务)$
 * @admin true
 * @public false
 * @priority 1000
 * @disable false
  说明：
    1、在红灯区同级目录创建一个文件夹，名字随意 如：自用插件 和 public
        添加定时任务.js 放到自用插件下
        创建 Bncr_spy定时任务备份.txt 到 public中

    2、触发示例
          定时 2023-05-09 11:42:00 export a="b"
        或
          定时 2023-05-09 11:42:00 https://www.baidu.com
        或
          定时 57 41 11 9 5 * https://www.baidu.com

    3、设置一些变量
      （必填）需要接收通知的用户id 多个用,连接
      set Doraemon bncr_spyNotifyAPI_recipientUserIds xxxxx

      设置需要发送通知的平台（默认tgBot）
      set Doraemon bncr_spyNotifyAPI_notificationPlatform xxxxx

  ----------------------

  注意：
   1、简单测试可用
   2、无界超授可用
   3、自用插件
  ----------------------

  功能：
   1、通过把 2023-05-09 11:42:00 格式的时间转换为cron，再通过bncr_spy添加定时任务（已实现）
   2、时间支持cron 格式 57 41 11 9 5 * （已实现）
   3、支持判断链接或export 变量判断定时任务是否存在（已实现）
   4、如果传入的时间小于等于现在，则不进行处理 （已实现）
   5、支持清空过期定时任务，如果清空过期的定时任务成功，则会执行重启命令（已实现）
  ----------------------

  更新日志：
      v1.0.0 插件上线
      2023.5.9 v1.0.1 新增 时间支持cron 格式 57 41 11 9 5 *
                      更新 功能注释
      2023.5.9 v1.0.2 新增 支持判断cron是否过期，如果过期则不添加定时任务
      2023.5.9 v1.0.3 新增 支持清空过期定时任务
      2023.5.14 v1.0.4 优化 日志写入位置更改
      2023.5.16 v1.0.5
      2023.5.17 v1.0.6 支持 扫描重复定时任务 相同变量相同时间的定时任务（export形式的），会随机将相同的定时延后一分钟，如果有多个重复的，请多执行几次。
      2023.5.21 v1.0.7 支持 成功添加定时任务后，通过机器人发送消息提醒，需要设置新的参数
      
*/

const Doraemon_tool = require('./mod/Doraemon_tool');


//插件入口
module.exports = async s => {
  /** Code Encryption Block[419fd178b7a37c9eae7b7426c4a042034021abec61d6b057ca88f2d42e1dfa46774be74efc7810c9aff09157c916c5c0c72d30543824950871595d7d9f4816c194f757208a025504ca88cf4c0dc50f0d00267429d4a43d5df8113d4a90c3729dd5043d5f5ed19233810b9814c7031afc63796731e476e479ebeffc45b6ce0505e4cb23950266f5fc1fb16649ad54d784c6725bf3f0258982dc69d309317c6836cdcf458a535f0666e3bf35a7b2a070c7edf470bbc3618767737f8771fb47f66cb49cf486da771569cb8fe721bc8af010976d92e901de6ea4b1d37a79cdb52d5a53387b3d60714dbd50235475a14d05b8daf58ba805e372a47234a2500b1abd53eccc87714a07561c575daab9e9584d83a8ca73ca19cd4eaefcda89f2a50ff147f85a9fed70428060b778297f829c0d534f0a4aaa4989f20c0b67aa476784fc6bbbe94941a5aacf9083af5ace290d7968bf49675ac8b009744824fbb941e3e967e7512cff6638f7e419809b506ca92cf2a84b3dcc09141238eca4cfd1274d76f6767d0ce6b4f961c02c2f5c26c7e3206211bbafcc34eb41ddaf727eac47b3e29de27935310711caa9d3dbbab58609eff4f02927eb9eda5dcdf8c796271ebe2679e37766991128fbbf2038ae5601f4ac5b77118df11f3f0c7773d0b1fe5c92e43a1fc0bfca2516560e09d2a6e953b912d948e02726665934c6a167945135b258bbbb100c6bbd4349fdfcb1b658ae41384415367b911cf5d9cf61bbd74a5e5293eea5d7f884fc491c79193810784611420d8930680a6b9235edb75c93a69d200bc45b05cd8d06cf8929f5e8d9f7530ecb34c6ea5fb34dcd40a2840dd674ab496ea96ef8d85756807eb1aae6ba44a1fce7b401e64901d8a648f537182b8b3b181716fda33e95ce68de29373b50a8d42bc7ac82ceff81d5b71044d6cb36e626ded2a540e1f6dec0a674ff885c697b8718d91db90bef8fc684e1322b77e72e1211ef717aa5017873b3d2bb2dc9aa66a30773096cbd88219d867d456a9ca9b7154aa9864323972dc88644fa656953ca04d4fe6f0b811e34d8ab679117d5148677c59d29df02ab287a6ec617d71c87b45df10ecd915f221f5b91d30a0d14fb157ff576f178af761220037282c9eb1fc39bce1fe76d7557f7d563249b629679afc8350aaf150c29851512235398b15cc7301a2102a3dc6798ebc970a0378ec7d5a8727c88680613e5f94e1ad1e2b785aafdac25f68219fbec98608f857c6c2794dcfd6ae32993a54b476ac91e4dd8db1fc785b3b893140b3aa9ec007ee0e8d50745ae5b4dd9aef7a5694d570b5428d2c014090f84ddadba32898a2b9624b3d0838326a108b0d1f1a091b110e6d1e6357668c62628354687eefbcf7625417432bd7165ca3336529f6e0b159639b76704777bc80f6b87203edb8f15d47a9725477acfee79553aeb827c323188df508d8db05cc4edaa84d8350fbd4970827c1c277901801adf98b788ff16ce65b139c9aeb80a22b1cdc04b612b76458c364f1251c0c80ed54e0da2c5ed14b1bb4a4ffe8ab1f2d7e21aff5a5fc96b8f52b1a738a11053ea2f5d6c5f8a1b9eb9f2a24caa6194bb60862a71da007954d5fc7b2e2203172aea746f09394208363bc5d838e30f2c0b0a0b3d102012e444407f046cc6abe4e0b054732a3de564d497326d4e622264e53001f1ea7e8b405c74410cd9e26ba5efa5bd0ecffdfbe38eef996c7b081f09757e309d19632c90a727617ccdf363e0d85c84e7ca19cfde94e1fb9866d9fd2f0b5886bacf93dc110bd13bfbdb1a36dee7fa347f4ed53d11e47f8d73751f4b690a798141caecabc078671016f5b0b466911208a05f52872a26edce6a9f0390bad1c390cffc7b24e992a36782e6692b0cc042f5e89e093945a8ed3c2160f1a4848492acef60c38e4442305b70dfdd91294f94069d403b6970ca83aa5f1a325dfaed78106e9b2209fb565ff9d739edb2fc37fcacb0e43713c688cbf928d6efad3be4e37a4b2cd4ec71f89e2b2f0e1e8b6d8b3b89703031fb8082c41ba00e7df09c22bda639d25a10a8b3f753abcb87f7a00e28ba9d81590bedd10b1332df49bb2282b49e07353f22e9c5b1df31e4851c9986603cd2715b3a9d179bd0268bce2b9e9c83f99040b28659ee33b8858a0efa7af04da831bc021c35b836fdafecc5f7ca07470c62c6bf1ba62b32f80db48c97ea561bffdc9f4a5863b3b605948b216e1e5d6678c4ff473e91658b15b9837a86b233518494b1df8fc282e5a8f54d4d4f72967772bead876c3b612be8ee142f8f273a8f4c310d07598b8b517ca46fe5e67dab1e8aa0a56a862f764d004147e6a78458b68f0fecfd9648e8b3f929904e5b763e0362dc8846ba8e9124a77a6a0ffae247a843c4595625e926605262311843660b6c4829a03747f1cd28765232f5b7af26f64245f08faa6e33d935703eb0a6431da404ba272c398e3c602da558a8366a6fb28f33c0f3dafeb9e88fcdce7b4ba84d1dc961c74a4227f0c50c9d3b039049f9883a199b2d7e857ee832345a0e0b8db5894093db2decaeaa7f4b3682748eb55d8aece6d94755fc8a717e9d6b2fc1b51e00fc6cd4eacea4e482183c826eb235b7170dde4d660d06c1dc939c9833ce092f15f3f818cfb1f89b89d782f440391403b4ed401d43a89924c515d00f99ba3a31027fb12a515cf3610c1eadad53f3088786b9be17e8be176be0d13f0ab4e141d6db9844faa64fa70c451d3f46f50371ca678192b3650a62cdfb025e2724c44e86be88161d24937e5bbbe8b7d3bc34fc7a6ab96e2b632b24917d718cac80ac73eca1784fe6eb6cb94a5038d14f0b28e25be81e915fca82d706cf5a12971965456e4d6400be0ef1a7aa6c8521096ec7a3b2dbb601348492431aff4226b4370919bd3fd958ef7a12eaadff94b0d5839538a14c23d9026e6535ba9757fe8511c3a1103500c9aadf420e84e782054b46b3637af49ceb8399cc43e69d65c7a0495eac184ab7aafb9d075aef8ded04f7c62328b2ebbec145479c331db472a6431a2f9b1e91835b8f270d1ac4f83f6b5599db71039a1b4e723cad58d7a0bb16207a6f108d99b2ac4230380b4640cc900df6ce9287cf14baf80601ebed2b59418b07dabc2723cce43ea2d630344f86a1e55667d10301c774f630d8d1bb7780664f587b4c3b2101f600ad50d467cb9a4ac337d045dd3a6fb291ac190381c1584ebfa53b3250d295a999eb1d0c874e52d8f7882e62b8823b9fea281f63717c374c7975bedd22a4538fa8bcb1adf33f9de4eb312ade1ff4b56d50f5452080866ff1a725ab0a2b65a0d986fc88f45493f93007f2c101d33a8cecd325ec075f0136b21299ffa906e413d8b08822aa7a7f64e417928457f97d89d8f6233deb2777fdcec23d330d60d4a10c69e6839232f9c22c21d8949e52a379bf9a97284ef8d7938fcc7c117cad4bae603c4088f95b8bfa54264f42b3e71ad47edc0b6f7c9b3352c810e005d67cf85cf6a8b201d2058b07a20c9445394ec3083b4bba6d9168c901af34d18d37940a2d7f57acc217887712af925a5f5bf3eb8ac933b61b67eb93aba2a72ce4b052e3c87ef03d758942524141263ec2057073c5480bdcec14f415ddf41c43bfcc02d612a6ca904c6e213d5db881b246f09ef7f1f341209f3194b1eb1a51f106758d502c2938650a4f3f40acd00d8d6a4a25fc52a8ff03a85b3a451de22c7baf7b116781d857021e0b220e450d49e838ef0e99867127450d45b45a4f522ea938e10a70b0425065e6249b039027a024e36d7649836611eac40aa658e636c6c6372686ffc9442419271019f0613cfef376e935267fa380a7a81177728f2d097c0c73c91f4b0746f64ce0eb6b27fd69880581e79ea8dc781668a7d1923b6efe44a13765a129aef54312dd3b56e4aeb4c9d506d411a4c823242b18c805440e1eb4de19c7ed1c55d357665dd4d6cfcae4a18508152ed8b132d270aef0445b58500d01f1c29066814c67741cd33cebf712a20a2412a9e07c01061f05aa7d220f44a694ca00d0db7db4c40279aebeb89833d17147b814ecbf5882ecf3658a66da7bdb041381e31e7f81bd43f2f3142635c31ff49949dcc979c3b8dd897bb92ded910ecde91c33c1ac4b7b245a6c0e92e132b82ac93e9a6f0cda23a3b636b952773038f05729bcfc2175bffaa6a911889a5b1bf37589a1bb9cd93c776f0d8aeeeba9532da634988e3eb7c0de1e195970c7eaf031d5daab3b0d4cdb055212f0e295a0a8d7c7146c7f92a49a0f8b324cae5dd9ad9e2a00e107bfcb084afc3366aed5c0d4017768004534ac42e6bb243f29709a04c2f4e5671842811355fd850afd93a154ed6f77f56143b9bee3323911acbf5256baf7304347556cd3028c9ffdb0898dcbdf509211fa4f15e7de7e7000ba374947222084175ae1c471f7e0059d38da0f604962afd6fb2717f5ed7336bce2926336650b6ecf78cc8fc8f513696e85128b1f77384c62758b81ebc21061239d0be986bed8dd78add68b561a68b289a79ae9bc00848a8cfe79c6c9417e94d7e184b3a3c54a5f8e32600277054858be58fc375743617dc1fea9cba2fcef0967f8c4debf1a5bb684f2954e951e128803a7dfbe91f875b31945e24946033ede276e333fe9d3a30859bc2b5450fc67c001255b0e5a98c9804d9a14ca2aa4125fd0b0d2a41732df19e98c994691ba957ea0dcd5447bf7a0455ddc1c4a465cfd4eb29f1982f05328927c274e15b664bc9840dba070f22901366896ce69a1d07bc4ac7ae22c5016237f22b029050f1b1e91bb89c2abd7936bf4616d5ce538f5c47698fdd347b5c4f7e387e3f5238cb232dca145ab1e1e07fad7a9166204b0c9b54382e0984c521449ccd54a5c0c6b9a74ed4128766c4303202a894d80a71c3cadd63a054a709505a6d9dab42a64a196bcce9a9c9602e97280dec08efad9444618edc5b8d690003770ec0b2baaa98c807e8762d19ecc372d118989b5e4069b5a6bb93023f8dfc5794af3a989890fc5d31bbfd1056b8030311b090ef3f956e8af123638591fbe105d9ea458fd07278761862c579352a8ce86ecb6e88714fd038781c2b13b00b7874419e88e20dab918d7b20adc5a3e267bb98b9f91e85586a77a20280c48eb42c03ed52b58de20dd81eeae7308c27f918125c1f975b6ea176456012434fb5628bd92f019711a731e60ceb3d9a637d6f6a6c04961f714696a7fd2fccf212dcc9da55004d3bd7d0ac6c41890555d40a696097cce516cd03903e06664896f0ad6e0601ecbfc325fdc252aace75eaf9392ab74840b7314814ce12046fe0e4e11d6c83b473f252fda2c99bb09df513331808cbf6fd9a420366c5d41cb3f268af91aa40c003cb345f734b948f44da56a80f813968d54d4f1a3d73d770281adac61cb38cd4fff23db79a67022bac052ee86696bcb40a2c8976c3ba591527996b51af4e7e38f2bf3188a733aba236157ce012eddf458ca5183c3ca9a5e57a8cb10da95a5556ed22564cfa16fa45413c0b51c0a1fb5a51d59e3d716abf9456d4141a2874ff6e2b34aba799bc58083e29820274e3bce036f8ceda2df50c7356507cf4386d5310ec89eff7f617380504df042abb5fa86b29f6db6ecdb4b02bec4c76cac0f0153ac02dbf9214639c0f16d35e946e5147054111ca921a99a9bea640306e7e9ab427f7816690d4c335ec863a2b7f08600e68ac1b5d8a063b7fab1c83471960b18f2d191fd2ddea0181a013c154e4e1f36364016289ef0d7dde6ddabb230aef65af527c633650074fb2887933eec6c2d4ea3be0dae53e106e76a35c0057d7621b05e9e24b2f562e33c047f740e32dc0b8b6697c4cdda9c35fae99a60ea0d5b59ecdca33d5aa8bc5d538af967691d95f5c41b3217c60e179373bf09173d4d0626832066b40f0c62de1f9b9dfe722a67b2e6af67f5e7651cb9d24c76d9e2697e45955b8f3ac1b69a641be96efe7b74e6c1371e79e2cee120b0be98f36ed72484965591b745daf8a47a913419def6406457c8f1fffa8c7ee7f241aeb447e9707b7cfb907d26de5a181e9fa184cdb1c7197c833b7ae32e047a56f6e80e657e9f75199a2b9cf842ab18bec602e32588955d284c3c13b86af77b550118e6298f4a740b778e915a65d35c35e5b6c8eb47e69a823ce36297a9a919632baee882b57c0ca2f87abb80057503fd07b77242f31be5513a175985327a2f371dbb04a3b8825140d68c588a306afd178a8f1c78f49e2b682a6b03edc3da481fa689a4957b5c0a1a0c9bbf2e81b8ae4173a57362effe29428be74ce2f51c66f493181fe3da65fcbee98b3fcd8787a5778cbd49397bdc0070ac49137af352f107a0e24108c0da634679a810aa7f564ba4a026f0880d6d2c4cbf386171cb2f58144702955366decd46c8a36ee9575c2e008711881abbf4293044a7b5e299f744ae9d981f52d57f6f35dedd0d42cc150ea8d2619bdf13b94cec48822bbb4da1617fc2db1a715672523914778cf0fdfb6e03e63e591b9b8973221f43689d6e9b82061243ff6564b6cfed9cfc455dfed878b9acccadeb08a7c296f6dad8cbea76c5d70a2eb8c64be4a7c6b947c5223633b726c13299829b0f61be5750d0dc65779fd36697dea946107ab4df445e31fc1dc6c1deea31c09b2c099ac004edc73ef16ed4b0fadcec8fe9c27bc5a3e603d650d4cc82b2c42893426f2bee3cfcae703ea129e2a40982b7f3c2c49c75f886b1313b4e9ffc1839f2a3c10cc3106aa79d498d569c5de9df07b40c53462a8b1e6db3e57ae2eb82fc78a015ee50a134abe4ff1db36466f769293c7930d0e6f3f2e233989489c399b2a80827b16900ad2248f4bf24df970b80e762ba0332b354bdc914cbfb92b76732126b51db2de327e3b595a189f9c08a0bd5f430c8ede2caa8bdbb00bfed3ebb914af85b1b38effc0118df5842d0c0e00913e6262fbd78feef0dec5ba4fc4639eebad1bac1c1475c6e4d22ad2e61d6c8e6ebcfe61583777f0fc7057b6325573bd4c081dac2d497c99ff5dc77367bee214e62c01f54e65b5c22625bb88defa70390bda4c5b7e4fe6442be6792dd2783874c0494acbca04ed12d0ae03a7d87f7d7b29c04112eb81e06df06e50a0eeba8aeaca7d95527b5839a4d297f0962fa9412e497df2e492cd4f2442b4ce8ac38b5fce0ccd2d1ef4c08f7986861fa8e2b988ee7b671fa0376931236d71fd5a579431479a4d9b44eee7cb4469e26e511dfdab908fa95ba8fed75e8db5b8826adaf74a927dc30bb415f9840898d089f87b71407d9d1d13eba6e1746e2e32d0182da9fbc66b75810d80d46814ac7dc0d5ac2e83fd8f261493179d854355a4b4152db963266b614a320fe09810d26d20df737fe7bdc5c0a6697cbe15cb161a4d92b9b47347222c35f109628787a4600376aa30bacb7b45105d9b46af3a303f888a1b9d67e56432c91b4eff70147b0fcd733f9d77ef5a9660c77ae0199fa5d75a26fcd28e4605114bca49be5f6536f47656f294d4be312bf19cf6e5ee004b2cfc6bec6535de163397d401eea06f9ae38ba9962583706eec17d247ec0a919769fecbbbb581c6fe4aacdfca728fdf22a865e1253883157c002eb688feb6127f8ff4b94333feed169abc2270872e904762cc75882073ebc5d9d3b09c957f50b32f9290693a9b63b67c421be4cccd0e4fcb871ed8e672abfeb106762e6a68554182aecb51e7d2f00bebfaf760ae78dd1b6865928e7723e60374e5d68e530a986f18154d7214e9e60ca978a5a1a58ec59b69a479cf76b1db4906af30acbdde0c8a1240fd33927b6a6d93ca94382021d493a85499c3022194c9d9adc97bcce1d6840c29215a11770d7b9c066424f239b5407e8b88f7ebf2c2ddbcd168de77d12d34a9e6c775b8e7f82e619d7b5e69706adca5e70d037a477adaf0c4d91e6f46d64e89ba8b97d59bcc0de1a64b5b7f7048a50e052603e9a946fd3c7885028dad4e17618b230ec96a8763be3bca4aadbf1857be42d6d10bdb3e94bbe3bede6bab78a04522d29d89d727d3a1d57d0540ca49b053cc0f2fefdb518994dc8a5256bad225a555ca7f39764e996db8c2378d3f9fbbf67440a44a1dcb3fb8f65c432cdc8098ba87a2e7a8dd39a0a876df38b95e6943750299da2a3257f527cbbf0088550e98dde753ba489a1414287aee1924707a7dceb9defb3fe671871779d698a7ec773bb8e3ae16ce2c8c2170a23b728fbab01a7670c6986f6bee558adaa9ba9aadbd129cee6e3fd83a70827d7177fb8bd81d91696957c707b310cad9f080d75e682c65cd6b3d8389f1061e839836d281bfadef1f867dc666ba2e358d67c8079472432032b965f88b015aa01708e22664499771ff0a5dba8bc029591bec118e5628d8c9edeacc09338cfbf92ddd173d7d1ae8f6e56b7ec7624cf3ba4c3d503330f80ff4d5fb576e51ad68a7e0b171aee7d4a8ffc07d75c14c4f1eaf7d1c5475391eec94769741948b091fdc625b8a9271cc89903ff588b4617740749fe05fc45d6db39167553ef7e1f0227647d182bd87c8575530a035de2564d25769ac2f992ccfc9b9a958b682ec74ff59de7cf1828125f179f3a05331bfaa8ee9c194676bf6b3b6408f6d1f4821b7d724ddf014795e7197012231ea2f1430599ed8eb23e15072d5b0083ec6ffe9b146e4df107dbaba55943e24d4e4eb2ff1103fe5298962456b1cf99bace0a1e8a53ef22a67916779ece0743c4d8c4f1c01c881aaae66a8d410ce55b589677ac74c7982555f830bcc536178371c1aea0ef74f603df6e67139be903b2e5ca8444d52f0358e5a68e7327b5d9c32281a3c62021e388774917cf3dc784842a2d1ab666fd2d6e2babd4f43b79ec93cafa15096f85104e1045232b670eeb3b1ab3bb956b459a58caf157d70587642c70998f8b0b54ea36aade0edfee7ccee8bf7901] */
};
