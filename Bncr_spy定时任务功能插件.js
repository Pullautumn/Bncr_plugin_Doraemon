/**
 * @author Doraemon
 * @name Bncr_spy定时任务功能插件
 * @origin 红灯区
 * @version 1.0.7
 * @description Bncr_spy定时任务相关功能插件
 * @rule ^(定时) (\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) (https:\/\/[A-Za-z0-9\-\._~:\/\?#\[\]@!$&'\*\+,%;\=]*)
 * @rule ^(定时) (\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) (export[ ]{1}[^ ]+[ ]*=[ ]*"{1}([^ "]+)"{1})
 * @rule ^(定时) ([0-9]+ [0-9]+ [0-9]+ [0-9]+ [0-9]+ \*{1}) (https:\/\/[A-Za-z0-9\-\._~:\/\?#\[\]@!$&'\*\+,%;\=]*)
 * @rule ^(定时) ([0-9]+ [0-9]+ [0-9]+ [0-9]+ [0-9]+ \*{1}) (export[ ]{1}[^ ]+[ ]*=[ ]*"{1}([^ "]+)"{1})
 * @rule ^(清空过期定时任务|扫描重复定时任务)$
 * @admin true
 * @public false
 * @priority 1000
 * @disable false
  说明：
    1、在红灯区同级目录创建一个文件夹，名字随意 如：自用插件 和 public
        添加定时任务.js 放到自用插件下
        创建 Bncr_spy定时任务备份.txt 到 public中

    2、触发示例
          定时 2023-05-09 11:42:00 export a="b"
        或
          定时 2023-05-09 11:42:00 https://www.baidu.com
        或
          定时 57 41 11 9 5 * https://www.baidu.com

    3、设置一些变量
      （必填）需要接收通知的用户id 多个用,连接
      set Doraemon bncr_spyNotifyAPI_recipientUserIds xxxxx

      设置需要发送通知的平台（默认tgBot）
      set Doraemon bncr_spyNotifyAPI_notificationPlatform xxxxx

  ----------------------

  注意：
   1、简单测试可用
   2、无界超授可用
   3、自用插件
  ----------------------

  功能：
   1、通过把 2023-05-09 11:42:00 格式的时间转换为cron，再通过bncr_spy添加定时任务（已实现）
   2、时间支持cron 格式 57 41 11 9 5 * （已实现）
   3、支持判断链接或export 变量判断定时任务是否存在（已实现）
   4、如果传入的时间小于等于现在，则不进行处理 （已实现）
   5、支持清空过期定时任务，如果清空过期的定时任务成功，则会执行重启命令（已实现）
  ----------------------

  更新日志：
      v1.0.0 插件上线
      2023.5.9 v1.0.1 新增 时间支持cron 格式 57 41 11 9 5 *
                      更新 功能注释
      2023.5.9 v1.0.2 新增 支持判断cron是否过期，如果过期则不添加定时任务
      2023.5.9 v1.0.3 新增 支持清空过期定时任务
      2023.5.14 v1.0.4 优化 日志写入位置更改
      2023.5.16 v1.0.5
      2023.5.17 v1.0.6 支持 扫描重复定时任务 相同变量相同时间的定时任务（export形式的），会随机将相同的定时延后一分钟，如果有多个重复的，请多执行几次。
      2023.5.21 v1.0.7 支持 成功添加定时任务后，通过机器人发送消息提醒，需要设置新的参数
      
*/

const Doraemon_tool = require('./mod/Doraemon_tool');


//插件入口
module.exports = async s => {
  /** Code Encryption Block[419fd178b7a37c9eae7b7426c4a042034021abec61d6b057ca88f2d42e1dfa46774be74efc7810c9aff09157c916c5c0c72d30543824950871595d7d9f4816c194f757208a025504ca88cf4c0dc50f0d00267429d4a43d5df8113d4a90c3729dbccb60488e07fc226a1f8553c6f48cb4c68c810ed46b4b7c18ec18725cff641450e376606d7fbec63bb6b4ebd3ba452ba4eb5442eda19ddd8f7fabd753d9f2ce5be1832eb99305c3335df9af7ecf6ffa8cd2f5e3869ca3a5e8f42cc5806b4c60689b55aecd417bd271e4d2b8b69b57cb44ec6648f64871e18ea71f5099cec1af31ef3545d3c6f4c3d37b53d4b1e5095f03921f98cf147dc04704e8e1201a6502b416e046606356d29c1326145f254210689686b5128c1f4b41a777e9c7c6e77bda6fdc736eed518cb450e73cb34e96c9cdcc77f9d571232047629c9dd143eb80572caf9104838d3a2c5589fc7091ea5baa0bece22a6919d4a0817eccb65f4621e15f3d9f17b06937684bb9906d1cd632e9ab019c584954b7fe3e1fe2d996160d5e162240a3477c56d4bf7ed6a74f3f605a044ed057cd4736979686f2345d2c802e2c83cbbf44dde56ba87f00594ffb6823d627014feff94bdaf1c26ca8d8003676efefee8b7d17f44d02bdabc764e1e6d42ebe6cf238daaf3a5e41774130d945fbeb0935f28de47794ec0595cb8ad01820d0e8b9ea3312ee41256db90a0c40ba3185c44a04531b2332e0c561d0dae89e213fca1f94bf394bc7c4f9718bf0b66d44d2e1ef3037925fcbe509133b34bfe54864afa66ebf968e7e7dfea80f27cdda99c9638ff7432fea79d0d162b2e016c73f8424123d1df2ef2df30bd752a92dc2a064edd47676fcfb707adec56515429c8834d97c3c3a7f80269c43419c1722cb97f301b42ff66b3395d6e7ee8e48462eda11fe887ecf008600aec0dcfa3633fe99db2c97492b0e18898ef126c821ba569c64e7f147717eb2ac01a6610873fa8737c936f7ed2f0fa93ab9218392e88803e86c1c9deb4ffb77fda5c9f2301a725c305c9c8a1e534dabbae8f55aa4ab15fde6945353e7f0567a9efb4d752747567e168a82beb42f7275e18fd067742e16fb0bf3ea0afcfb0b3d1b2049063aaff47ef6ea707f16cbeee94db1145f9d91d3d8228a1e6d077cbe6e7722a48f49506edb058bd6c0c01fb56cb5dcae36a18316fbf008b6d174b4e7844bccc5de0a3660b3e130a665bad6d100de9b1233be9021e7c2b9d5bbefd67b523293f184049b6b1665900e9ba9333d5e776bc64cab4a8cde11ed179ff84d7d510e7022374e16a8447d37c99126850156efa49f1150fd0aaf493283dc6f7cad0ed043e664683c2f7d05e92822b0997a36a518cc0044bd1c2d64130f5472b9326b553173f42c095c2526ebe7b922214c7a590ac2681e4fba9deb561c3422a53682aa7c2a8f4f3364d0b011246dc03f7234b5e29cac368db30279c107083def03d01374ecab56852f5684dfac93714d80a59eb8b85f790d4d86288f5cba0b1ada8dbaba5fde8255288ebdfaa2fbc4871edf1e6c914a90efa49431d361fe55e70472cd7a0acec45e618d316c57f53f7392a6fbf0d81b531b2a9aca01eeeede7b94d90c71807e2ed0959c77efe0f7fc15e938a48267974f4dac0d737f6a3a73b965f49ffb6490844d4f6b27e1cb970be5b1139d8fe31365310aea6b27c9616dda0fa9295a2bb8e9deb7266c0dd81c1f3e56cd167e7ab7887ad5da27c246f62a36119fc19b13432f8e71a88d582a485dca294473bec25fe4fed4325a24054c9e31c86ceb304c39ab6fac6198ed6ddab8f41a7f0ee0e26a9f9bd8bdf090e49067484316a4af1feb191d1f72475ae1a57a20287cc51bf7fa9dbd18dffd2cc09064ce5e6baad1647df6f552db42f9db0f0709fc8ef5222cf517fec45af2e5d0e7b211de174f803c1f135b07cf9691458f934efdcd9d4c2bb83831d3d0c28e03933ded2c4161076b961f40241e3d09eef785a8e0ab874a9232058632fe29abe3d014427a591235811f7227aa8b86105d54105aa434005c6095236e12542f3e4ba4e0ca3045a486d8bf76afe102db4a8463479418df1634da255db4ab465e7df643774d008e4f05e4ebe0b307985b9607210a811a950c5c092037947602095b6797b9cf7b32f022ac1f23c6a4590854e71ee15e14d45024572c9e76926fd563e73a94fddf5fce13edfcf269ae7340c0afd293ef2625a73e4418a5fddd0acad767c0857af1c406583ed29605b45f464784fd58ee3bdb0280be7c63e8851ada63cb80cb14832e2b09c902736c3b52bd0f50f9c0a63144b227a1decc09e69ea6b54c54a724af155cdf7553fdb181df26bd23965ce71b450bb2522a4d4dc134b52d2e780d35cce14478154e681ac2bd15189a18394928c069acac2f7a825d1b50185b502aa1e0e158d7ddf976669327779a83e1baa2f51ff87dffb54061ffcb1e8fe6c70fba2591743884c858a4f614c9e61c7319ac994541d390b5cfc27d436bdbfee69c60e6d8cd207a28bf2c7500d0ad23b136ab4659ea30e35333099db949c13e0e394104e028c7877e60c5168490c90bd732dca81172dabc93a5b59e950d5baa181cd93176453f984063321f27ccf6e7f3af992d75ed7dc1091fb49b7fce1337ae9cede4d73cc3b3e99051f53e20adc60aa15d9b1535fba76f82f5197dd22f166a9ac76e990f685d98d0afc3b30182b4d4cba491dfc05a22961331c2e5add7b6d6299e7696644e7581897a6a6c1e0117f35f65773168ba6bfe2ad0845e2d74972ef6e58acdaeb9fe2732fb3a72b75f1c6c5fd96971403297aa80f707fcc84f3dd2fc3bb239c11fbe0962f73d41ed17c1bdd018469cc5e6bf8910a1c4817c33b7830a07673911fd99c886435e8f90670c92a2b3f53cd61778d4e0ae74d4dd947faa42c92e88ab9d36ef6e25e1242995c6f07389999008f76b38e818ed9f3c67f323b6631d1421000e073bd3113b06e0a5dccf0e100658ed53e2f259a582c5714185b68cb13083af5e8496b57d8c9ecc9cff2ae632c393ffbe54db9a1f24cc97a13f9bb2ef5a4a151fcdfa98a7a94ea94f10f609267f78f61f5387c3096655f8d24177da94c8f62d2a86f8035f6902ff1b75960987daa19fd20fa91e51a154b0e72a5670d2b2528b2a078ce9b0772f6d3a70cf5963cd33e8c7e6fe645c33298b7e1e2edd16b53e8206576cc2d2246ff82b5bac28fd071d9c7948ca302de54df5694dcbca97b9fe952aa4343f1bcc4abee6d2c92316023e11257d08700ea8dc611b62085394867b435f7a5a8e86943d38ea38e0d42bb97a56ea3babdf66149d89438ad1b0d6e626fad2139fdfe3ae1ae47056e28918f1ab2c4b11dd02baee5b46486cc0bbaedb1270509e5c3e4206e57e63c13b649dafa211e3f24109c2ee5129b0e3f1bdd2d42748f6cdce4a303e6b36a23cb6680248f64e51a56cfb773cdec130733176399c56ae915b1cc901d462202bec4fd9530e6134f1b38118e03d5c3db38451dd278a177e0cc93c36f7053ec5fca95d07d18c201349f33fe1698258657aceeecbfdf6e1340bdd97d361d70485c54eb28f41bd8d3756e2ae42bafb3492c752a5ce628a96cfb227647542688af3e35c4d7e68cb212eb89cae0accf43f566cf0ce90fd6cf4d295d488c1973642fff2a0fdd4a2dd57be2c778c1da9d5ddd7980ee5ea1e711dd2763c337daa9760ea3b1b9a7662dbb72c27ce1d55c6ecfe20dd3fb4af0f99283febd60cdd58693358b2bdb6ea58ab03db84743f3ec03a0d8fee31b75fb034f5e5847f2f4a4815bf8df6711d3558e223973f0a7ee73c782b88577908b8b766bffeb4fba667995f0af417a94a1305b9468407f8aa40b06f91ba8cb9bb8adf7e4f624b80bdd329b6bfab4b931b78e4573e96640d2e627a3fb5a3a1e8f1d05ad72452091f9eb274e6d0945952bde3600e35bd07b373a3a208d803e98c50eb356c35469bf96985e50cf4c4943f4270b2c9227a8330ce459d3d4b304b8834ff5d1237489e5a4819db948138cf9535492942f68be2cb4093e6e24b9c6efdd739dd5233cf7ec06d90b55ae590fa254f8d981c71d687e573e7b98ce1bab9138b641970924f9e5e1b2b000e1de1bd76663e657d12e21f51c7d80283f9809a175964daec06f3d3bad8a9f50f2203dc72510dab2653f77b9bd93c61a7fc50eeb8f3b69a930f7e8199b16510f2d23915df90dd552deacab12041241e4d3bbdacf1574dfdbc5df49fa168dd3af75400e4e9108171e7ab57fbcedf53a8de9361d90c97201bdc532660c6f017c0630c48f5e6621fb359770339030f1af9c407f9df1cd33e1327b70595c445ee502ff9e2c939601482a4661087676abf8d6276af2f8f926a1faccd53b16fe2824c2f15cfb695e2ea1a4940eedfa15a894312697cb8c404df44310fe258d5ddd5e48d7178539f5de5009e3fb42ffaa2c390c560ffdea4a33e0976f23230656adc5b3f84b884025749da43290835315f164352b19d5f7aceebd95fccfe5a6a71e5610cd4f4fb2a513b802a01ab95d2fe4d843ce0a911399f4172cd1dc91f248262a7025ed40d471834819727605df303ef23b2daaf8d968e7c3b5b1ef094724286aebc90bf35aeef9bdb63798ab713f90d0fe034d95b83399914ff4beb8842b4ee2090fb33141f4be8b58ccb99a49e0da432babc054cec8175d00300c04c16ae65871b517207385a3ad946e389e701358a9bd65a0dbf757165ebe162ab02a5b0c99a83042f2479accc2fbbc29712af28e9bfcbf8c764b91a56451a27e3afa5b8893751ad1f82afa501f6379770943969418474d9557958592e7412b278d47b5018a139df39522007243b1b2d3ace22ea1d2c3438215b07fc0c4f4b98b6d08199ae93dbd17e21697604af8f61d712b98b003c9b9630f7de06e7794243d5a04c84cb721a48942171c48b5d7a8db2073a764c57dbf179b232a6be91c1841ae1c49d2704bed9f0f9036106eb472d91bee4cac8076c4bcf5e51e4befd3bd45b3546fb0677fba5f848e9e107e4feb0ae2b88944dd9b8777f304754ddef7f0c2bef0b8bf5257abecca22545138dc3d1ac57e60201e9474c62e5ace5375c5cfe1aa53997a7b3caa62dbbd3cbae892e8bffe5ffdcc863fb1919684fa62601b94e1a60a53c8e6a71dc909e873743e2763344eb6ccfe2c5bfd20993edeac1554bb23086ab78bb1ae7266a364e9bd8a4c5f67874fef7438d6ec2d7c61c6f337ebce174b3603fde745170e4b64aa7c546bfb7a86b3b5b5610a8b5a34af7a0a7adbb5c00d3c84f36afea0f2734f171c3471dd22997bce6c66eb108e5f1dac727b37d360005b2a7b54cc31c5a680130c7d1ec8754e4baead5a1e9d362927f5fca4b587435d5c7352e1165696c13b184c78a69cc14e587b8ec08d8749b4be36231ceba685f409b058825070ecc79e3e2ddf545c645188abcd05e87edc511056b730ee5641cbe1ee03e50604351d1ac1bf02f50be716ba57b998fd0b33b263b1e314590314c3252de8a1172a766fbe0e4d154518d4d1fe23a613734d8ade2a44930ac3fcf7c60414a4b888f9142c1f2d8a90e81930ace4e5c08b9d87810cbd292ba101e657db05fc3376d78e012bbc2a5afc8330c2e68eff068e7ced8d73db19023caf1d97798a732bbd36a1bcf2b599ab5c155bbba560a218b1f2b27eaec060b2e223d0ed5b3c7953cc0ade6d72826ec224275fb9c2488223da9fc11190591722234e03fa4ec0cbd27d7121952eccfee93ec665365213168b605c03011ad1b631d4c7fd2b4ca623a1c7f1c278960dbfaae7e96e3e12b1bbb6ca137e706fe8eefdf2dd0aee50cbd1d003f227a592aeedc7b5751d5f1fd8b5e941092f83e6ff596fee2efa0e427a2daef286f9eb22f72b069d8780017ceb33c7a75a7402f819951990c563be8e3550595f6243421374793e8ffde3bd8830f34b7be67982363d0e6fbd4870f157968750720a0c421bfb57bb9803658c5a1be1af96cb3660b5795434a3a3a814bb4065b7959edd596b1eae441bab4ff23db97e490bbd08d58fc50cebebfef75c6a99b6e0d2355aa3d7af181487c218bc221d7877531d5c15d4e7f8e05bc431c45433441fdabd66a73c2e683b821ebab275af398a638a11a548c61224a0fbcd9442f05ddf21918f7d59058f4133b94adc28cd6f58d1dbaff2b33d092ae296c498f9767de84b855f506be2a0f03a7d18a2239633ccc6434da1218afcaf852b49cd15f3f4fbc0ca7570dbd5d0a6a6312d8f66b05390d5a169b586e9ea0e92a07be9b1cda34011513893f5743fe6e69272fc9429b0a6cca119b7c3ad2c5022f8421c6233780b3d33b7a3b1c6852192405a9e531cd23129245568083ad770746167f2f5c92554f18f75448708e7907c54a39e4cffb2b764852e7747590f7622313ce80c1c73df9ce38d0b22646e6f95c8cf425c11e5039cf730e9dc6f955d1360df1790db12b06e6bd60c331d5d4cc163b93829dd549b16948119dba60b66178646cbffb1eb53e86efd017a5a2d4a8499684fe725a2c42737321261bf81c5d8ba87d1ef82df71938c9ef57ae1d4245f389f045e3ad3b2f21fced53664781cbe37332ec67e4edbf8228e13b66d9d34576440ed84ccaa82cd5d28c823600cab6dc4b1036e30333475bc7b0265deec33785f67bc8e4be01f50b544760dfc9729b8027f9f23c07fc6691f0dce13346a8fc1cabaada5013a189ec45e7a76a7476721cb90f64dde4e94872ff6759f9331af2e57596db2117d6e5e9593bca52b6ff1cc9c008342d9dccb5934b227bff1ac7d03b309b40d353602cd9552d1ce36fa2d6697c74bf6f14445bbc2a09b07ac790d3b34a3eced790727dfe6626f3974125c268613eb271f3f3001ced40016a1b8d556ce4777ce68de63d4a0faea96e4893cccce0906690248ef8108cb1933b546087dd6356ea62a593f87b2196d66a7c54bc522e0e966901396204b9f3b3edcb77076b4605540960298dbf70d578055a2563d35d5259c0b9c44ec1024e9215fd74ff23542360489c8f85e701fba770cfbea99ce74c6cf4cd35b6f3b127245a2aea77e575374615f8db1c4ac4dedceddd68529442cd8cb9d09ba13b06dff3201c102f482032044188c6e91ddcee274d7fb6f59b636b2554ae528579b08fa23e01de68dc69c5e61e64a08266ca1c9ff2f91e888be93015ab618e566d7775dbde6a9fa7c84a7aec0389d496187b335f6560df6a6b866c1497047116aba557b88be475d0eef23b2ecc478a07a385b5a0abf084bb0e72de6c69255331126e4adc02504658366025f7b99d045a6a6b9665fdd8a93592277c8e4b74b5da77ac9ad4d60f2048885346c63c399de13e32fccd954cc9a5414ac337dcc5dea513b09840488c090440be0af4bdce053c56c1c52ffc2cd3c95791c7f17dfb90f19de52b005266e3873966613f709a575e0bc4db5aeea4d57dc8ccc38e81bdb721891700ca76276ac89f799f684882804136fcea1322910d4d7546b0601670f39c9a2245b45b3a107b1bcd7cb5a4efeff991264096049d04e06b13ea067d38cf2d8613a886ec9da796a15a478e9a8ff8f9da1f76a5d2b1f0d932f2795396551ee27e9c5fb10afaceea49e496033e36e9b33a18abc640e2a61a443ad03c6f3a8c3b01a76af9f8c8c7c2f87e5e8b32131e62aa31547735209894dc5fc429118c5497d9a21806e10f356bbfa6cc144d7faa06964f33bb268b744c6ab825b28e2b6ccc6f1c816212f1a6f9f088f7bc354d654d32e5f8e15642ee828fc9fbded50440240b2f52099e4b63793db83f84057448b58e851d5be88f065729eb55d91e97372cf32f2a677e3ab9d38f13c7251e2b4c9f7a8665219fb9b3b0f0a0eb8711023195e4831221a504fc926dfb7c28c5da0b4318b64bd78466074f85bc4b4dc91b008490018d37b4e856f9925165df50fdc417e934655ef9cc6e4e2cacfe07eca894f9d8ff841aa40926d66b60a5238b50447a1fd2481c1b06f8313bd43a1d7dee1845d30d2609777360d8546728c1a267ec43f26a90e6a093b497da020b2f248d309d9a20362fe3b4946ab31cf7523f4cca278f11e7d41fed48c69f6911ba90f2f425e871440343152627be61e624a57ba7cd49daf9496ef13d0dd3c6589912439a6061c079faab78b1ef1e91371bc5fbb07c10d919d8a04c1749d013d2ca1a986299dafda441614409af03d7736b471edc1eb6bb027bfba68aaf95a53372e61e18eaa26516304b4d25e5ec12953851519a8ac3d14f4228673ec0e0aeb0f7db6fa98d0de4f5adb063f134f43e33c2c3824623a3a173445aa931bbce1dd9d772660138720100e43f91a28131b84d1109f462c0500815d5d0d8a896944cfb068eb3483e9c24ca966f8f8f4f3d62d264ac31e4f0743c0d047bf55ed554adbcc79649ca19808afdddb1c497c0bd302e4f09923d2daa6544d658dc0425deb5d18b109e66c225f0b01e349b9ebf4c2dec34ac5d783bd91f7ff7c943303160ef9cac6c17cb4ee80bfdb6e2972151923ab85cff63c0acea7c8bb90c164fc9dbdb8ad2d7dd213a5f0047e058fd8fae00307e9d17ab477109f9eda041607616deb4fd4153ce03ceb68585859b8326b5bf65e7a188b1a5f82f567eb1feaae3d273f4a4ebcfc7b9cfbffecab9c6c1d42c14fb05f6a9a47e04a1182a365f4fb16d142c779c7292c9400f973c2a774415a2adec4f7faf6c619ccc6dad51b4d95ab9563033125be9c042e92e19d4883d3abfd03d078766624b06417e6a9a869b34f1408db5e56c5333771610ef390df0534f8a03cd41bc98769a1eed9a2a6799ccccdf84491c9db52ba835ac5d079dc54e8cf6aa12d172ebcaf8cb8bc060c6bcd25d89f72d7ac86d10397e2b] */
};
